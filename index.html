<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Financial Ticker</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: transparent;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        .ticker-container {
            width: 100%;
            height: 80px;
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border-top: 2px solid #0f3460;
            border-bottom: 2px solid #0f3460;
            overflow: hidden;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .ticker-content {
            display: flex;
            align-items: center;
            height: 100%;
            animation: scroll-left 45s linear infinite;
            white-space: nowrap;
        }

        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .stock-item {
            display: inline-flex;
            align-items: center;
            margin-right: 25px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            backdrop-filter: blur(5px);
            min-width: 160px;
            flex-shrink: 0;
        }

        .news-item {
            display: inline-flex;
            align-items: center;
            margin-right: 30px;
            padding: 10px 16px;
            background: linear-gradient(45deg, rgba(255,69,0,0.3), rgba(255,140,0,0.2));
            border-radius: 8px;
            backdrop-filter: blur(5px);
            min-width: 350px;
            border-left: 4px solid #ff4500;
            flex-shrink: 0;
        }

        .stock-symbol {
            font-weight: bold;
            color: #ffffff;
            font-size: 15px;
            margin-right: 6px;
        }

        .stock-price {
            color: #00d4ff;
            font-size: 13px;
            margin-right: 6px;
        }

        .stock-change {
            font-size: 11px;
            font-weight: bold;
            padding: 2px 5px;
            border-radius: 4px;
        }

        .positive {
            color: #00ff88;
            background: rgba(0,255,136,0.2);
        }

        .negative {
            color: #ff4757;
            background: rgba(255,71,87,0.2);
        }

        .news-icon {
            color: #ff4500;
            margin-right: 8px;
            font-size: 16px;
        }

        .news-text {
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
        }

        .market-status {
            position: absolute;
            left: 10px;
            bottom: 5px;
            background: rgba(0,0,0,0.9);
            color: #ffffff;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            z-index: 100;
            white-space: nowrap;
        }

        .crypto-badge {
            background: linear-gradient(45deg, #f7931a, #ffb347);
            color: #000;
            font-size: 9px;
            padding: 1px 3px;
            border-radius: 3px;
            margin-left: 3px;
        }

        .etf-badge {
            background: linear-gradient(45deg, #32cd32, #90ee90);
            color: #000;
            font-size: 9px;
            padding: 1px 3px;
            border-radius: 3px;
            margin-left: 3px;
        }

        .loading {
            color: #ffffff;
            text-align: center;
            padding: 30px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="ticker-container">
        <div class="ticker-content" id="tickerContent">
            <div class="loading">ðŸ“Š Loading real market data from Alpha Vantage...</div>
        </div>
        <div class="market-status" id="marketStatus">ðŸ”„ FETCHING REAL DATA</div>
    </div>

    <script>
        class AlphaVantageTicker {
            constructor() {
                // Your Alpha Vantage API Key
                this.apiKey = '1CEUSIYJVLEYZUSP';
                
                this.tickerContent = document.getElementById('tickerContent');
                this.marketStatus = document.getElementById('marketStatus');
                this.newsIndex = 0;
                
                this.symbols = ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'TSLA', 'NVDA', 'SPY', 'QQQ'];
                
                this.news = [
                    "ðŸ“Š Markets respond to latest economic indicators and Federal Reserve policy decisions",
                    "ðŸš€ Technology sector continues to lead market gains amid innovation surge", 
                    "ðŸ’° Investors closely monitor inflation data and interest rate expectations",
                    "ðŸ“± Major technology companies report strong quarterly earnings growth",
                    "âš¡ Energy sector shows resilience as global supply dynamics shift",
                    "ðŸ’Ž Cryptocurrency adoption accelerates among institutional investors",
                    "ðŸŒ Global markets react to ongoing geopolitical developments",
                    "ðŸ¦ Banking sector demonstrates stability in current rate environment"
                ];
                
                this.init();
            }

            async init() {
                console.log('Initializing Alpha Vantage ticker with API key:', this.apiKey);
                await this.updateTicker();
                // Update every 12 minutes (Alpha Vantage free tier allows 5 calls/minute)
                setInterval(() => this.updateTicker(), 720000);
                this.updateMarketStatus();
                setInterval(() => this.updateMarketStatus(), 60000);
            }

            async fetchAlphaVantageData(symbol) {
                try {
                    const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${this.apiKey}`;
                    console.log(`Fetching Alpha Vantage data for ${symbol}...`);
                    
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    console.log(`Alpha Vantage response for ${symbol}:`, data);
                    
                    // Check for API limit or error
                    if (data['Note']) {
                        console.log(`API rate limit hit for ${symbol}:`, data['Note']);
                        return null;
                    }
                    
                    if (data['Error Message']) {
                        console.log(`API error for ${symbol}:`, data['Error Message']);
                        return null;
                    }
                    
                    const quote = data['Global Quote'];
                    if (!quote || Object.keys(quote).length === 0) {
                        console.log(`No quote data found for ${symbol}`);
                        return null;
                    }
                    
                    const price = parseFloat(quote['05. price']);
                    const change = parseFloat(quote['09. change']);
                    const changePercent = parseFloat(quote['10. change percent'].replace('%', ''));
                    
                    return {
                        symbol: symbol,
                        price: price.toFixed(2),
                        change: change.toFixed(2),
                        changePercent: changePercent.toFixed(2),
                        isReal: true
                    };
                } catch (error) {
                    console.error(`Error fetching Alpha Vantage data for ${symbol}:`, error);
                    return null;
                }
            }

            async fetchCryptoData() {
                try {
                    console.log('Fetching crypto data from CoinGecko...');
                    const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,ripple,cardano,solana&vs_currencies=usd&include_24hr_change=true');
                    const data = await response.json();
                    
                    return [
                        {
                            symbol: 'BTC',
                            price: Math.round(data.bitcoin.usd).toLocaleString(),
                            changePercent: (data.bitcoin.usd_24h_change || 0).toFixed(2),
                            isReal: true
                        },
                        {
                            symbol: 'ETH',
                            price: Math.round(data.ethereum.usd).toLocaleString(),
                            changePercent: (data.ethereum.usd_24h_change || 0).toFixed(2),
                            isReal: true
                        },
                        {
                            symbol: 'BNB',
                            price: Math.round(data.binancecoin.usd).toFixed(0),
                            changePercent: (data.binancecoin.usd_24h_change || 0).toFixed(2),
                            isReal: true
                        },
                        {
                            symbol: 'XRP',
                            price: data.ripple.usd.toFixed(4),
                            changePercent: (data.ripple.usd_24h_change || 0).toFixed(2),
                            isReal: true
                        }
                    ];
                } catch (error) {
                    console.log('Crypto API failed, using fallback data');
                    return [
                        { symbol: 'BTC', price: '68,500', changePercent: '2.15', isReal: false },
                        { symbol: 'ETH', price: '3,650', changePercent: '1.85', isReal: false },
                        { symbol: 'BNB', price: '395', changePercent: '0.75', isReal: false },
                        { symbol: 'XRP', price: '0.6100', changePercent: '3.25', isReal: false }
                    ];
                }
            }

            getFallbackData(symbol) {
                const fallback = {
                    'AAPL': { price: '195.25', change: '2.15', changePercent: '1.18' },
                    'GOOGL': { price: '2,891.50', change: '-12.30', changePercent: '-0.44' },
                    'MSFT': { price: '388.90', change: '5.67', changePercent: '1.52' },
                    'AMZN': { price: '155.80', change: '-3.25', changePercent: '-2.18' },
                    'TSLA': { price: '258.75', change: '12.40', changePercent: '5.24' },
                    'NVDA': { price: '895.30', change: '25.60', changePercent: '3.01' },
                    'SPY': { price: '495.30', change: '3.25', changePercent: '0.67' },
                    'QQQ': { price: '408.70', change: '5.80', changePercent: '1.48' }
                };
                
                return fallback[symbol] ? { symbol, ...fallback[symbol], isReal: false } : null;
            }

            async updateTicker() {
                console.log('=== Starting ticker update with REAL DATA ===');
                
                const items = [];
                let realDataCount = 0;
                let fallbackCount = 0;
                
                // Fetch stock data from Alpha Vantage with delays to respect rate limits
                for (let i = 0; i < this.symbols.length; i++) {
                    const symbol = this.symbols[i];
                    
                    let stockData = await this.fetchAlphaVantageData(symbol);
                    
                    if (!stockData) {
                        stockData = this.getFallbackData(symbol);
                        fallbackCount++;
                        console.log(`Using fallback data for ${symbol}`);
                    } else {
                        realDataCount++;
                        console.log(`âœ… Got REAL data for ${symbol}: $${stockData.price}`);
                    }
                    
                    if (stockData) {
                        const changeClass = parseFloat(stockData.changePercent) >= 0 ? 'positive' : 'negative';
                        const changeSymbol = parseFloat(stockData.changePercent) >= 0 ? '+' : '';
                        
                        let badge = '';
                        if (['SPY', 'QQQ'].includes(stockData.symbol)) {
                            badge = '<span class="etf-badge">ETF</span>';
                        }
                        
                        items.push(`
                            <div class="stock-item">
                                <span class="stock-symbol">${stockData.symbol}${badge}</span>
                                <span class="stock-price">$${stockData.price}</span>
                                <span class="stock-change ${changeClass}">
                                    ${changeSymbol}${stockData.change} (${changeSymbol}${stockData.changePercent}%)
                                </span>
                            </div>
                        `);
                    }
                    
                    // Delay between API calls to respect rate limits (12 seconds between calls)
                    if (i < this.symbols.length - 1) {
                        await new Promise(resolve => setTimeout(resolve, 12000));
                    }
                }

                // Add news
                items.push(`
                    <div class="news-item">
                        <span class="news-icon">ðŸ“°</span>
                        <span class="news-text">${this.news[this.newsIndex % this.news.length]}</span>
                    </div>
                `);
                this.newsIndex++;

                // Get crypto data (this is fast, no delays needed)
                const cryptos = await this.fetchCryptoData();
                let realCrypto = 0;
                
                cryptos.forEach(crypto => {
                    if (crypto.isReal) realCrypto++;
                    
                    const changeClass = parseFloat(crypto.changePercent) >= 0 ? 'positive' : 'negative';
                    const changeSymbol = parseFloat(crypto.changePercent) >= 0 ? '+' : '';
                    
                    items.push(`
                        <div class="stock-item">
                            <span class="stock-symbol">${crypto.symbol}<span class="crypto-badge">CRYPTO</span></span>
                            <span class="stock-price">$${crypto.price}</span>
                            <span class="stock-change ${changeClass}">
                                ${changeSymbol}${crypto.changePercent}%
                            </span>
                        </div>
                    `);
                });

                // Add final news
                items.push(`
                    <div class="news-item">
                        <span class="news-icon">ðŸ“°</span>
                        <span class="news-text">${this.news[(this.newsIndex + 1) % this.news.length]}</span>
                    </div>
                `);

                console.log(`=== UPDATE COMPLETE ===`);
                console.log(`ðŸ“Š Real stock data: ${realDataCount}/${this.symbols.length}`);
                console.log(`ðŸ’° Real crypto data: ${realCrypto}/${cryptos.length}`);
                console.log(`âš ï¸ Fallback data used: ${fallbackCount}`);
                
                // Create seamless loop
                const content = items.join('');
                this.tickerContent.innerHTML = content + content + content;
            }

            updateMarketStatus() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    timeZone: 'America/New_York'
                });
                
                this.marketStatus.textContent = `ðŸ“Š ALPHA VANTAGE REAL DATA â€¢ ${timeStr} EST`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸš€ Starting Alpha Vantage Real Data Ticker...');
            new AlphaVantageTicker();
        });
    </script>
</body>
</html>
